import{b as T,a7 as ee,ap as q,a4 as J,aH as W,i as S,ax as ye,c as V,aO as Q,ac as be,ad as xe,bf as he,_ as j,a as B,u as A,e as u,o,j as e,J as ae,bg as te,g as a,am as N,n as E,aK as se,r as K,p as $,t as b,az as oe,h as ke,a6 as we,bh as $e,aa as Se,aE as Ce,H as O,C as Ee,a9 as Ve,aB as Be,ae as ne,an as Ie,G as le,w as ze,k as h,m as C,L as w,M as D,bi as X,f as P,b5 as re,aC as Ue,be as ie,z as de,bb as Re,A as R,bj as Pe,b7 as Y,E as ue,aL as De,F as Z}from"./index-CCW7ggxn.js";import{E as Le,c as Fe,a as Ge}from"./pagination-BID9Pb1l.js";/* empty css            *//* empty css                */import{g as Ne,d as Te}from"./order-FeanXstX.js";import{C as Me,U as H}from"./event-BB_Ol6Sd.js";import{E as ce}from"./index-CBOGfRJ6.js";import{E as je}from"./index-DVu_leTe.js";import{E as Ae}from"./index-UVZ7bM1T.js";import"./index-dK_BwzaO.js";import"./isEqual-Bkhcy90j.js";const pe=T({modelValue:{type:[String,Number,Boolean],default:void 0},size:ee,disabled:Boolean,label:{type:[String,Number,Boolean],default:void 0},value:{type:[String,Number,Boolean],default:void 0},name:{type:String,default:void 0}}),Ke=T({...pe,border:Boolean}),me={[H]:_=>q(_)||J(_)||W(_),[Me]:_=>q(_)||J(_)||W(_)},_e=Symbol("radioGroupKey"),ve=(_,m)=>{const i=S(),s=ye(_e,void 0),l=V(()=>!!s),v=V(()=>Q(_.value)?_.label:_.value),n=V({get(){return l.value?s.modelValue:_.modelValue},set(f){l.value?s.changeEvent(f):m&&m(H,f),i.value.checked=_.modelValue===v.value}}),x=be(V(()=>s==null?void 0:s.size)),c=xe(V(()=>s==null?void 0:s.disabled)),r=S(!1),k=V(()=>c.value||l.value&&n.value!==v.value?-1:0);return he({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-radio",ref:"https://element-plus.org/en-US/component/radio.html"},V(()=>l.value&&Q(_.value))),{radioRef:i,isGroup:l,radioGroup:s,focus:r,size:x,disabled:c,tabIndex:k,modelValue:n,actualValue:v}},Oe=B({name:"ElRadio"}),He=B({...Oe,props:Ke,emits:me,setup(_,{emit:m}){const i=_,s=A("radio"),{radioRef:l,radioGroup:v,focus:n,size:x,disabled:c,modelValue:r,actualValue:k}=ve(i,m);function f(){oe(()=>m("change",r.value))}return(g,y)=>{var d;return o(),u("label",{class:E([a(s).b(),a(s).is("disabled",a(c)),a(s).is("focus",a(n)),a(s).is("bordered",g.border),a(s).is("checked",a(r)===a(k)),a(s).m(a(x))])},[e("span",{class:E([a(s).e("input"),a(s).is("disabled",a(c)),a(s).is("checked",a(r)===a(k))])},[ae(e("input",{ref_key:"radioRef",ref:l,"onUpdate:modelValue":p=>se(r)?r.value=p:null,class:E(a(s).e("original")),value:a(k),name:g.name||((d=a(v))==null?void 0:d.name),disabled:a(c),checked:a(r)===a(k),type:"radio",onFocus:p=>n.value=!0,onBlur:p=>n.value=!1,onChange:f,onClick:N(()=>{},["stop"])},null,42,["onUpdate:modelValue","value","name","disabled","checked","onFocus","onBlur","onClick"]),[[te,a(r)]]),e("span",{class:E(a(s).e("inner"))},null,2)],2),e("span",{class:E(a(s).e("label")),onKeydown:N(()=>{},["stop"])},[K(g.$slots,"default",{},()=>[$(b(g.label),1)])],42,["onKeydown"])],2)}}});var qe=j(He,[["__file","radio.vue"]]);const Je=T({...pe}),We=B({name:"ElRadioButton"}),Qe=B({...We,props:Je,setup(_){const m=_,i=A("radio"),{radioRef:s,focus:l,size:v,disabled:n,modelValue:x,radioGroup:c,actualValue:r}=ve(m),k=V(()=>({backgroundColor:(c==null?void 0:c.fill)||"",borderColor:(c==null?void 0:c.fill)||"",boxShadow:c!=null&&c.fill?`-1px 0 0 0 ${c.fill}`:"",color:(c==null?void 0:c.textColor)||""}));return(f,g)=>{var y;return o(),u("label",{class:E([a(i).b("button"),a(i).is("active",a(x)===a(r)),a(i).is("disabled",a(n)),a(i).is("focus",a(l)),a(i).bm("button",a(v))])},[ae(e("input",{ref_key:"radioRef",ref:s,"onUpdate:modelValue":d=>se(x)?x.value=d:null,class:E(a(i).be("button","original-radio")),value:a(r),type:"radio",name:f.name||((y=a(c))==null?void 0:y.name),disabled:a(n),onFocus:d=>l.value=!0,onBlur:d=>l.value=!1,onClick:N(()=>{},["stop"])},null,42,["onUpdate:modelValue","value","name","disabled","onFocus","onBlur","onClick"]),[[te,a(x)]]),e("span",{class:E(a(i).be("button","inner")),style:ke(a(x)===a(r)?a(k):{}),onKeydown:N(()=>{},["stop"])},[K(f.$slots,"default",{},()=>[$(b(f.label),1)])],46,["onKeydown"])],2)}}});var fe=j(Qe,[["__file","radio-button.vue"]]);const Xe=T({id:{type:String,default:void 0},size:ee,disabled:Boolean,modelValue:{type:[String,Number,Boolean],default:void 0},fill:{type:String,default:""},textColor:{type:String,default:""},name:{type:String,default:void 0},validateEvent:{type:Boolean,default:!0},...we(["ariaLabel"])}),Ye=me,Ze=B({name:"ElRadioGroup"}),ea=B({...Ze,props:Xe,emits:Ye,setup(_,{emit:m}){const i=_,s=A("radio"),l=$e(),v=S(),{formItem:n}=Se(),{inputId:x,isLabeledByFormItem:c}=Ce(i,{formItemContext:n}),r=f=>{m(H,f),oe(()=>m("change",f))};O(()=>{const f=v.value.querySelectorAll("[type=radio]"),g=f[0];!Array.from(f).some(y=>y.checked)&&g&&(g.tabIndex=0)});const k=V(()=>i.name||l.value);return Ee(_e,Ve({...Be(i),changeEvent:r,name:k})),ne(()=>i.modelValue,()=>{i.validateEvent&&(n==null||n.validate("change").catch(f=>Ie()))}),(f,g)=>(o(),u("div",{id:a(x),ref_key:"radioGroupRef",ref:v,class:E(a(s).b("group")),role:"radiogroup","aria-label":a(c)?void 0:f.ariaLabel||"radio-group","aria-labelledby":a(c)?a(n).labelId:void 0},[K(f.$slots,"default")],10,["id","aria-label","aria-labelledby"]))}});var ge=j(ea,[["__file","radio-group.vue"]]);ze(qe,{RadioButton:fe,RadioGroup:ge});const aa=le(ge),ta=le(fe),sa={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8"},oa={class:"flex items-center space-x-2"},na={class:"space-y-4"},la={key:0,class:"flex justify-center py-8"},ra={class:"flex flex-wrap items-start justify-between gap-2 mb-3"},ia={class:"flex items-center flex-wrap gap-2"},da={class:"text-lg font-medium text-gray-900 dark:text-white"},ua={class:"text-xl font-bold text-primary-600 dark:text-primary-400"},ca={class:"text-sm text-gray-500 dark:text-gray-400 space-y-1"},pa={key:0},ma={key:1},_a={class:"flex flex-wrap items-center gap-3 mt-4"},va={key:0,class:"flex justify-center mt-6"},fa={key:1,class:"text-center py-12 text-gray-500 dark:text-gray-400"},ga=B({__name:"OrderList",setup(_){ie();const m=[{value:"all",label:"全部"},{value:"pending",label:"待扫码"},{value:"scanned",label:"已扫码"},{value:"paid",label:"已支付"},{value:"cancelled",label:"已取消"},{value:"failed",label:"支付失败"}],i=S("all"),s=S(1),l=S(10),v=S(0),n=S([]),x=S(!1),c=async()=>{try{x.value=!0;const d=await Ne({page:s.value,page_size:l.value,status:i.value==="all"?void 0:i.value});d.code===X.SUCCESS&&(n.value=d.data.results,v.value=d.data.total)}catch(d){console.error("获取订单列表失败:",d)}finally{x.value=!1}},r=d=>{s.value=d,c()},k=d=>{l.value=d,s.value=1,c()};ne(i,()=>{s.value=1,c()}),V(()=>i.value==="all"?n.value:n.value.filter(d=>d.status===i.value));const f=d=>{switch(d){case"paid":return"success";case"pending":return"warning";case"scanned":return"info";case"cancelled":case"failed":return"danger";default:return"info"}},g=d=>{switch(d){case"pending":return"待扫码";case"scanned":return"已扫码";case"paid":return"已支付";case"cancelled":return"已取消";case"failed":return"支付失败";default:return"未知"}},y=async d=>{try{const p=n.value.find(z=>z.order_no===d);if(!p)return;const L={pending:"待扫码的",scanned:"已扫码的",paid:"已支付的",cancelled:"已取消的",failed:"支付失败的"}[p.status];await je.confirm(`确定要删除该${L}订单记录吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),(await Te(p.order_no)).code===X.SUCCESS&&await c()}catch(p){p instanceof Error&&console.error("删除订单失败:",p)}};return O(c),(d,p)=>{const L=ta,G=aa,z=ce,F=re,M=Ue,I=Le;return o(),u("div",null,[e("div",sa,[p[4]||(p[4]=e("h2",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"订单管理",-1)),e("div",oa,[p[3]||(p[3]=e("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"状态：",-1)),h(G,{modelValue:i.value,"onUpdate:modelValue":p[0]||(p[0]=t=>i.value=t),size:"small"},{default:C(()=>[(o(),u(w,null,D(m,t=>h(L,{key:t.value,value:t.value},{default:C(()=>[$(b(t.label),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])])]),e("div",na,[x.value?(o(),u("div",la,p[5]||(p[5]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-4 border-primary-500 border-t-transparent"},null,-1)]))):(o(),u(w,{key:1},[(o(!0),u(w,null,D(n.value,t=>(o(),u("div",{key:t.order_no,class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 sm:p-6 group"},[e("div",ra,[e("div",ia,[e("h3",da,b(t.order_type==="monthly"?"月度会员":"年度会员"),1),h(z,{type:f(t.status),size:"small"},{default:C(()=>[$(b(g(t.status)),1)]),_:2},1032,["type"])]),e("div",ua," ¥"+b(Number(t.amount).toFixed(2)),1)]),e("div",ca,[e("p",null,"订单号："+b(t.order_no),1),e("p",null,"创建时间："+b(new Date(t.created_at).toLocaleString()),1),t.paid_time?(o(),u("p",pa,"支付时间："+b(new Date(t.paid_time).toLocaleString()),1)):P("",!0),t.expire_time?(o(),u("p",ma," 过期时间："+b(new Date(t.expire_time).toLocaleString()),1)):P("",!0)]),e("div",_a,[h(M,{content:"删除订单",placement:"top","show-after":200},{default:C(()=>[h(F,{type:"danger",icon:"Delete",circle:"",class:"!order-1 sm:!order-none hover:scale-105 transition-transform opacity-0 group-hover:opacity-100",onClick:U=>y(t.order_no)},null,8,["onClick"])]),_:2},1024)])]))),128)),v.value>0?(o(),u("div",va,[h(I,{"current-page":s.value,"onUpdate:currentPage":p[1]||(p[1]=t=>s.value=t),"page-size":l.value,"onUpdate:pageSize":p[2]||(p[2]=t=>l.value=t),"page-sizes":[10,20,30,50],total:v.value,layout:"total, sizes, prev, pager, next",onSizeChange:k,onCurrentChange:r},null,8,["current-page","page-size","total"])])):(o(),u("div",fa,"暂无订单记录"))],64))])])}}}),ya=de(ga,[["__scopeId","data-v-1ef1d386"]]),ba={class:"bg-white dark:bg-gray-800 rounded-lg p-6"},xa={class:"flex justify-between items-center mb-6"},ha={key:0},ka={key:0,class:"space-y-6"},wa={class:"flex items-center space-x-4"},$a=["src"],Sa={class:"text-lg font-medium text-gray-900 dark:text-white"},Ca={class:"flex items-center mt-1"},Ea={class:"flex items-center space-x-1"},Va={class:"grid grid-cols-2 gap-6"},Ba={class:"text-sm font-medium text-gray-500 dark:text-gray-400"},Ia={key:0,class:"text-gray-900 dark:text-white"},za={class:"grid grid-cols-1 gap-4 pt-4 border-t border-gray-200 dark:border-gray-700"},Ua={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ra={class:"text-xs text-gray-500 dark:text-gray-400"},Pa={class:"text-sm text-gray-900 dark:text-white"},Da=B({__name:"UserProfile",setup(_){const m=Re(),i={nickname:"昵称",gender:"性别",bio:"个性签名",location:"所在地"},s={last_login_time:"最后登录时间",last_login_ip:"最后登录IP",is_member:"会员状态",member_expired_time:"会员到期时间"},l=V(()=>m.userInfo),v=S(!1),n=S({}),x=()=>{const{nickname:g,gender:y,bio:d,location:p}=l.value||{};n.value={nickname:g,gender:y,bio:d,location:p},v.value=!0},c=()=>{v.value=!1,n.value={}},r=async()=>{try{const g=await Pe({nickname:n.value.nickname||"",gender:n.value.gender||"unknown",bio:n.value.bio||"",location:n.value.location||""});g.code===200&&(m.updateUserInfo(g.data),v.value=!1,Y.success("保存成功"))}catch{Y.error("保存失败")}},k=g=>({unknown:"未知",male:"男",female:"女"})[g]||"未知",f=g=>new Date(g).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return O(async()=>{m.isLoggedIn&&await m.fetchUserInfo()}),(g,y)=>{const d=re,p=De("Postcard"),L=ue,G=ce,z=Ae,F=Fe,M=Ge;return o(),u("div",ba,[e("div",xa,[y[3]||(y[3]=e("h2",{class:"text-xl font-bold text-gray-900 dark:text-white"},"个人信息",-1)),l.value?(o(),u("div",ha,[v.value?(o(),u(w,{key:1},[h(d,{onClick:c},{default:C(()=>y[1]||(y[1]=[$("取消")])),_:1}),h(d,{type:"primary",class:"ml-2",onClick:r},{default:C(()=>y[2]||(y[2]=[$("保存")])),_:1})],64)):(o(),R(d,{key:0,type:"primary",onClick:x},{default:C(()=>y[0]||(y[0]=[$("编辑")])),_:1}))])):P("",!0)]),l.value?(o(),u("div",ka,[e("div",wa,[e("img",{src:l.value.avatar||"https://api.dicebear.com/7.x/avataaars/svg?seed=Felix",alt:"avatar",class:"w-20 h-20 rounded-full object-cover"},null,8,$a),e("div",null,[e("h3",Sa,b(l.value.nickname||"未设置昵称"),1),e("div",Ca,[h(G,{type:l.value.is_member?"success":"danger",size:"small"},{default:C(()=>[e("div",Ea,[h(L,{class:"scale-[1.4]"},{default:C(()=>[h(p)]),_:1}),e("span",null,b(l.value.is_member?"会员":"普通用户"),1)])]),_:1},8,["type"])])])]),e("div",Va,[(o(),u(w,null,D(i,(I,t)=>e("div",{key:t,class:E([[t==="bio"?"col-span-2":""],"space-y-2"])},[e("label",Ba,b(I),1),v.value?(o(),u(w,{key:1},[["nickname","location"].includes(t)?(o(),R(z,{key:0,modelValue:n.value[t],"onUpdate:modelValue":U=>n.value[t]=U,placeholder:`请输入${I}`},null,8,["modelValue","onUpdate:modelValue","placeholder"])):t==="gender"?(o(),R(M,{key:1,modelValue:n.value[t],"onUpdate:modelValue":U=>n.value[t]=U,class:"w-full"},{default:C(()=>[h(F,{value:"unknown",label:"未知"}),h(F,{value:"male",label:"男"}),h(F,{value:"female",label:"女"})]),_:2},1032,["modelValue","onUpdate:modelValue"])):t==="bio"?(o(),R(z,{key:2,modelValue:n.value[t],"onUpdate:modelValue":U=>n.value[t]=U,type:"textarea",rows:3,placeholder:`请输入${I}`},null,8,["modelValue","onUpdate:modelValue","placeholder"])):P("",!0)],64)):(o(),u("p",Ia,[t==="gender"?(o(),u(w,{key:0},[$(b(k(l.value[t])),1)],64)):(o(),u(w,{key:1},[$(b(l.value[t]||"未设置"),1)],64))]))],2)),64))]),e("div",za,[y[4]||(y[4]=e("h3",{class:"text-sm font-medium text-gray-500"},"账号信息",-1)),e("div",Ua,[(o(),u(w,null,D(s,(I,t)=>e("div",{key:t,class:"space-y-1"},[e("label",Ra,b(I),1),e("p",Pa,[t==="is_member"?(o(),u(w,{key:0},[$(b(l.value[t]?"是":"否"),1)],64)):t.includes("time")?(o(),u(w,{key:1},[$(b(l.value[t]?f(l.value[t]):"暂未开通"),1)],64)):(o(),u(w,{key:2},[$(b(l.value[t]||"暂无"),1)],64))])])),64))])])])):P("",!0)])}}}),La={class:"remain-screen bg-gray-100 dark:bg-gray-900"},Fa={class:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8"},Ga={class:"flex flex-col lg:flex-row gap-6"},Na={class:"w-full lg:w-64 lg:shrink-0"},Ta={class:"hidden lg:block bg-white dark:bg-gray-800 rounded-lg shadow"},Ma={class:"py-2"},ja=["onClick"],Aa={class:"flex items-center space-x-3"},Ka={class:"font-medium"},Oa={class:"lg:hidden"},Ha={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-2"},qa={class:"flex justify-around"},Ja=["onClick"],Wa={class:"text-sm font-medium"},Qa={class:"flex-1"},Xa={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 sm:p-6"},Ya={key:0},Za={key:1},et=B({__name:"DashboardView",setup(_){ie();const m=S("profile"),i=[{key:"profile",label:"个人信息",icon:"User"},{key:"orders",label:"我的订单",icon:"List"}],s=l=>{m.value=l};return(l,v)=>{const n=ue,x=Da,c=ya;return o(),u("div",La,[e("div",Fa,[v[0]||(v[0]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900 dark:text-white"},"个人中心")],-1)),e("div",Ga,[e("div",Na,[e("div",Ta,[e("ul",Ma,[(o(),u(w,null,D(i,r=>e("li",{key:r.key,class:E(["px-4 py-2 cursor-pointer transition-colors",{"bg-primary-50 dark:bg-primary-900/20 text-primary-600 dark:text-primary-400":m.value===r.key,"hover:bg-gray-50 dark:hover:bg-gray-700/50 text-gray-700 dark:text-gray-300":m.value!==r.key}]),onClick:k=>s(r.key)},[e("div",Aa,[h(n,{class:"text-lg"},{default:C(()=>[(o(),R(Z(r.icon)))]),_:2},1024),e("span",Ka,b(r.label),1)])],10,ja)),64))])]),e("div",Oa,[e("div",Ha,[e("div",qa,[(o(),u(w,null,D(i,r=>e("button",{key:r.key,class:E(["flex-1 flex flex-col items-center py-2 px-4 rounded-md transition-colors",{"bg-primary-50 dark:bg-primary-900/20 text-primary-600 dark:text-primary-400":m.value===r.key,"hover:bg-gray-50 dark:hover:bg-gray-700/50 text-gray-700 dark:text-gray-300":m.value!==r.key}]),onClick:k=>s(r.key)},[h(n,{class:"text-xl mb-1"},{default:C(()=>[(o(),R(Z(r.icon)))]),_:2},1024),e("span",Wa,b(r.label),1)],10,Ja)),64))])])])]),e("div",Qa,[e("div",Xa,[m.value==="profile"?(o(),u("div",Ya,[h(x)])):m.value==="orders"?(o(),u("div",Za,[h(c)])):P("",!0)])])])])])}}}),pt=de(et,[["__scopeId","data-v-dfd18f90"]]);export{pt as default};
