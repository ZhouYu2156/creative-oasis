import{a as x,e as n,j as e,f as g,l as S,k as _,E as q,m as b,t as v,aL as I,o,z as k,i as l,H as $,bM as V,b7 as E,be as N,I as B,b1 as M,bi as R}from"./index-CCW7ggxn.js";import{a as T}from"./order-FeanXstX.js";const Q={class:"qr-code-container"},U={class:"qr-code-wrapper"},j=["src"],z={key:0,class:"scan-animation"},D={key:1,class:"scanned-overlay"},H={class:"scanned-content"},L={key:2,class:"paying-overlay"},O={class:"status-text"},A=x({__name:"QrCodeScanner",props:{qrCode:{},status:{}},setup(C){return(t,s)=>{const c=I("Check"),i=q;return o(),n("div",Q,[e("div",U,[e("img",{src:t.qrCode,alt:"支付二维码",class:"qr-code-image"},null,8,j),t.status==="pending"?(o(),n("div",z,s[0]||(s[0]=[S('<div class="scan-line" data-v-b8cac364></div><div class="scan-corner top-left" data-v-b8cac364></div><div class="scan-corner top-right" data-v-b8cac364></div><div class="scan-corner bottom-left" data-v-b8cac364></div><div class="scan-corner bottom-right" data-v-b8cac364></div>',5)]))):t.status==="scanned"?(o(),n("div",D,[e("div",H,[_(i,{class:"check-icon"},{default:b(()=>[_(c)]),_:1}),s[1]||(s[1]=e("span",null,"已扫码",-1))])])):t.status==="paid"?(o(),n("div",L,s[2]||(s[2]=[e("div",{class:"paying-content"},[e("div",{class:"loading-spinner"}),e("span",null,"正在支付...")],-1)]))):g("",!0)]),e("p",O,v(t.status==="pending"?"请使用手机扫描二维码":t.status==="scanned"?"请在手机上确认支付":"正在处理支付..."),1)])}}}),F=k(A,[["__scopeId","data-v-b8cac364"]]),G={class:"h-[calc(100vh-65px)] bg-gray-50 dark:bg-gray-900 py-12 sm:py-16"},J={class:"max-w-md mx-auto px-4 sm:px-6"},K={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-8"},P={class:"text-center mb-8"},W={class:"text-2xl font-bold text-gray-900 dark:text-white"},X={key:0,class:"mt-2 text-sm text-primary-500"},Y={class:"mt-2 text-gray-500 dark:text-gray-400"},Z={key:0,class:"flex flex-col items-center mb-8"},ee=x({__name:"ScanView",setup(C){const t=V(),s=N(),c=l(""),i=l(""),h=l(""),p=l("pending"),m=l(3),f=l(!1);let r=null,d=null;const w=async()=>{try{const a=await T({order_no:c.value});a.code===R.SUCCESS&&a.data.status==="scanned"&&(r&&(clearInterval(r),r=null),p.value="scanned",setTimeout(()=>{f.value=!0,d=setInterval(()=>{m.value--,m.value<=0&&(d&&(clearInterval(d),d=null),s.push({name:"payment",query:{order_no:c.value,signature:h.value}}))},1e3)},1e3))}catch(a){console.error("检查订单状态失败:",a)}};return $(()=>{const{order_no:a,qr_code:u,signature:y}=t.query;if(!a||!u||!y){E.error("参数不完整"),s.push({name:"home"});return}c.value=a,i.value=u,h.value=y,r=setInterval(w,2e3)}),B(()=>{r&&clearInterval(r),d&&clearInterval(d)}),(a,u)=>(o(),n("div",G,[e("div",J,[e("div",K,[e("div",P,[e("h2",W,v(p.value==="pending"?"请使用手机扫描二维码":"扫码成功"),1),_(M,{name:"fade"},{default:b(()=>[f.value?(o(),n("p",X,v(m.value)+"秒后跳转至支付界面... ",1)):g("",!0)]),_:1}),e("p",Y,"订单号："+v(c.value),1)]),i.value?(o(),n("div",Z,[_(F,{"qr-code":i.value,status:p.value},null,8,["qr-code","status"])])):g("",!0),u[0]||(u[0]=e("div",{class:"mt-6 text-center"},[e("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," 这是一个模拟支付页面，用于测试支付流程 ")],-1))])])]))}}),ae=k(ee,[["__scopeId","data-v-3a051686"]]);export{ae as default};
