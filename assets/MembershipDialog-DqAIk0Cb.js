import{b4 as r,a as z,bb as I,c as b,i as f,A as M,m as _,j as s,k as g,e as n,M as h,n as k,f as w,t as i,L as C,p,aL as O,E as R,b5 as j,be as A,o as l,bi as F,b7 as U,z as W}from"./index-efaOxweq.js";import{c as G}from"./order-XcvcrzSN.js";import{E as H}from"./index-ClkCYxdB.js";const me=async()=>r.get("/courses/types/"),ue=async e=>r.get(`/courses/categories/${e.category}/videos/`),_e=async e=>r.get(`/courses/categories/${e.category}/videos/${e.id}/`),ge=async e=>r({url:`/courses/videos/${e.video_id}/comments/`,method:"GET"}),pe=async e=>r({url:`/courses/videos/${e.video_id}/comments/`,method:"POST",data:{content:e.content}}),ye=async e=>r({url:`/courses/videos/${e.video_id}/comments/${e.comment_id}/reply/`,method:"POST",data:{content:e.content,reply_to:e.reply_to}}),xe=async e=>r({url:`/courses/videos/${e.video_id}/comments/${e.comment_id}/like/`,method:"POST"}),J={class:"text-center"},K={class:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6 mb-8"},Q=["onClick"],X={key:0,class:"absolute -top-3 left-1/2 -translate-x-1/2 px-3 py-1 bg-primary-500 text-white text-xs rounded-full"},Y={key:1,class:"absolute -top-3 left-1/2 -translate-x-1/2 px-3 py-1 bg-primary-500 text-white text-xs rounded-full"},Z={class:"text-center mb-4"},ee={class:"text-lg sm:text-xl font-bold text-gray-900 dark:text-white mb-2"},te={class:"flex items-center justify-center gap-2"},se={class:"text-2xl sm:text-3xl font-bold text-primary-500"},oe={class:"text-sm text-gray-500 dark:text-gray-400"},ae={class:"text-xs text-gray-400 line-through mt-1"},re={class:"space-y-2 text-sm sm:text-base mb-4"},ie={class:"absolute bottom-4 left-4 right-4 h-2 bg-primary-100 dark:bg-primary-900 rounded-full overflow-hidden"},le=z({__name:"MembershipDialog",props:{visible:{type:Boolean},onClose:{type:Function}},emits:["update:visible"],setup(e,{emit:E}){const $=I(),d=e,y=E,u=b({get:()=>d.visible,set:t=>y("update:visible",t)}),c=f("yearly"),P=[{id:"monthly",name:"月度会员",price:29,originalPrice:49,period:"月",features:["所有付费课程无限观看","配套资料领取","专属会员社群"],effective:!0},{id:"yearly",name:"年度会员",price:179,originalPrice:259,period:"年",features:["所有付费课程无限观看","配套资料领取","专属会员社群","技术问答服务","年度大会员专属礼包"],popular:!0}],x=A(),m=f(!1),S=()=>{var t;y("update:visible",!1),(t=d.onClose)==null||t.call(d)},V=async()=>{if(!$.isLoggedIn){x.push({name:"login"});return}try{m.value=!0;const t=await G({order_type:c.value});t.code===F.CREATED&&(u.value=!1,x.push({name:"payment-scan",query:{order_no:t.data.order_no,qr_code:t.data.qr_code,signature:t.data.signature,amount:t.data.amount}}))}catch{U.error("创建订单失败，请稍后重试")}finally{m.value=!1}},B=b(()=>{const t=window.innerWidth;return t<640?"95%":t<768?"90%":t<1024?"640px":"800px"});return(t,a)=>{const T=O("Check"),L=R,q=j,D=H;return l(),M(D,{modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=o=>u.value=o),"show-close":!0,"custom-class":"membership-dialog",width:B.value,style:{"--el-dialog-margin-top":"80px"},onClose:S},{default:_(()=>[s("div",J,[a[1]||(a[1]=s("h2",{class:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-white mb-4"}," 开通会员，畅享所有课程 ",-1)),a[2]||(a[2]=s("p",{class:"text-sm sm:text-base text-gray-600 dark:text-gray-400 mb-8"}," 为知识付费，解锁全部高质量课程 ",-1)),s("div",K,[(l(),n(C,null,h(P,o=>s("div",{key:o.id,class:k(["relative p-4 sm:p-6 bg-white dark:bg-gray-800 rounded-xl border-2 transition-all cursor-pointer xl:w-full",[c.value===o.id?"border-primary-500 shadow-lg scale-[1.02]":"border-gray-200 dark:border-gray-700 hover:border-primary-200"]]),onClick:v=>c.value=o.id},[o.popular?(l(),n("div",X," 热门 ")):w("",!0),o.effective?(l(),n("div",Y," 限时特惠 ")):w("",!0),s("div",Z,[s("h3",ee,i(o.name),1),s("div",te,[s("span",se,"¥"+i(o.price),1),s("span",oe,"/"+i(o.period),1)]),s("div",ae," 原价 ¥"+i(o.originalPrice),1)]),s("ul",re,[(l(!0),n(C,null,h(o.features,(v,N)=>(l(),n("li",{key:N,class:"flex items-center text-gray-600 dark:text-gray-300"},[g(L,{class:"mr-2 text-primary-500"},{default:_(()=>[g(T)]),_:1}),p(" "+i(v),1)]))),128))]),s("div",ie,[s("div",{class:k(["h-full bg-primary-500 transition-all duration-300",[c.value===o.id?"w-full":"w-0"]])},null,2)])],10,Q)),64))]),g(q,{type:"primary",size:"large",loading:m.value,class:"w-full sm:w-64 h-12 text-base font-medium",onClick:V},{default:_(()=>[p(i(m.value?"订单创建中...":"立即开通"),1)]),_:1},8,["loading"]),a[3]||(a[3]=s("p",{class:"mt-4 text-xs sm:text-sm text-gray-500 dark:text-gray-400"},[p(" 开通即表示同意 "),s("a",{href:"#",class:"text-primary-500 hover:text-primary-600"},"《会员服务协议》")],-1))])]),_:1},8,["modelValue","width"])}}}),ve=W(le,[["__scopeId","data-v-674c9a88"]]);export{ve as _,ue as a,_e as b,ge as c,me as g,pe as p,ye as r,xe as t};
